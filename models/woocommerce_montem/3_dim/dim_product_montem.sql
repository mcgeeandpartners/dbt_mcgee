{{ config(alias="dim_product") }}

select ID::varchar as ID,
    {{ dbt_utils.generate_surrogate_key(['ID']) }} as product_key,
    BUTTON_TEXT,
    DOWNLOADABLE,
    DATE_ON_SALE_TO,
    PERMALINK,
    SKU,
    EXTERNAL_URL,
    VIRTUAL,
    SHIPPING_CLASS,
    TAX_STATUS,
    SHIPPING_TAXABLE,
    MANAGE_STOCK,
    TOTAL_SALES,
    CATALOG_VISIBILITY,
    DOWNLOAD_LIMIT,
    BACKORDERS_ALLOWED,
    DATE_MODIFIED,
    DATE_ON_SALE_FROM,
    BACKORDERS,
    DATE_CREATED_GMT,
    TAX_CLASS,
    AVERAGE_RATING,
    NAME,
    SLUG,
    DATE_ON_SALE_FROM_GMT,
    REGULAR_PRICE,
    DATE_ON_SALE_TO_GMT,
    SOLD_INDIVIDUALLY,
    GROUPED_PRODUCTS,
    STATUS,
    SHORT_DESCRIPTION,
    DATE_MODIFIED_GMT,
    CROSS_SELL_IDS,
    SALE_PRICE,
    UPSELL_IDS,
    FEATURED,
    BACKORDERED,
    TYPE,
    ON_SALE,
    PRICE_HTML,
    PARENT_ID,
    VARIATIONS,
    MENU_ORDER,
    STOCK_STATUS,
    PRICE,
    REVIEWS_ALLOWED,
    PURCHASABLE,
    RATING_COUNT,
    STOCK_QUANTITY,
    DATE_CREATED,
    WEIGHT,
    DESCRIPTION,
    SHIPPING_REQUIRED,
    PURCHASE_NOTE,
    DOWNLOAD_EXPIRY,
    DIMENSIONS_LENGTH,
    DIMENSIONS_WIDTH,
    DIMENSIONS_HEIGHT,
    SHIPPING_CLASS_ID
FROM {{ ref('stg_product_montem') }} 
where not _FIVETRAN_DELETED

union all 

select product_id::varchar as ID,
    {{ dbt_utils.generate_surrogate_key(['product_id']) }} as product_key,
    NULL as BUTTON_TEXT,
    NULL as DOWNLOADABLE,
    NULL as DATE_ON_SALE_TO,
    NULL as PERMALINK,
    NULL as SKU,
    NULL as EXTERNAL_URL,
    NULL as VIRTUAL,
    NULL as SHIPPING_CLASS,
    NULL as TAX_STATUS,
    NULL as SHIPPING_TAXABLE,
    NULL as MANAGE_STOCK,
    NULL as TOTAL_SALES,
    NULL as CATALOG_VISIBILITY,
    NULL as DOWNLOAD_LIMIT,
    NULL as BACKORDERS_ALLOWED,
    NULL as DATE_MODIFIED,
    NULL as DATE_ON_SALE_FROM,
    NULL as BACKORDERS,
    NULL as DATE_CREATED_GMT,
    NULL as TAX_CLASS,
    NULL as  AVERAGE_RATING,
    product_title as NAME,
    NULL as SLUG,
    NULL as DATE_ON_SALE_FROM_GMT,
    NULL as EGULAR_PRICE,
    NULL as DATE_ON_SALE_TO_GMT,
    NULL as SOLD_INDIVIDUALLY,
    NULL as GROUPED_PRODUCTS,
    NULL as STATUS,
    NULL as SHORT_DESCRIPTION,
    NULL as DATE_MODIFIED_GMT,
    NULL as CROSS_SELL_IDS,
    NULL as SALE_PRICE,
    NULL as UPSELL_IDS,
    NULL as FEATURED,
    NULL as BACKORDERED,
    NULL as TYPE,
    NULL as ON_SALE,
    NULL as PRICE_HTML,
    NULL as PARENT_ID,
    NULL as VARIATIONS,
    NULL as MENU_ORDER,
    NULL as STOCK_STATUS,
    NULL as PRICE,
    NULL as REVIEWS_ALLOWED,
    NULL as PURCHASABLE,
    NULL as RATING_COUNT,
    NULL as STOCK_QUANTITY,
    NULL as DATE_CREATED,
    NULL as WEIGHT,
    NULL as DESCRIPTION,
    NULL as SHIPPING_REQUIRED,
    NULL as PURCHASE_NOTE,
    NULL as DOWNLOAD_EXPIRY,
    NULL as DIMENSIONS_LENGTH,
    NULL as DIMENSIONS_WIDTH,
    NULL as DIMENSIONS_HEIGHT,
   NULL as SHIPPING_CLASS_ID
FROM {{ ref('int_products') }} 