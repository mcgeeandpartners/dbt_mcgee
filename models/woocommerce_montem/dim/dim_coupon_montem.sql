{{ config(alias="dim_coupon") }}

SELECT ID as coupon_id,
    {{ dbt_utils.surrogate_key(['ID']) }} as coupon_key,
    DATE_EXPIRES_GMT,
    PRODUCT_IDS,
    USAGE_LIMIT,
    DISCOUNT_TYPE,
    USAGE_COUNT,
    MINIMUM_AMOUNT,
    EXCLUDED_PRODUCT_CATEGORIES,
    USED_BY,
    DATE_MODIFIED,
    DATE_CREATED_GMT,
    LIMIT_USAGE_TO_X_ITEMS,
    INDIVIDUAL_USE,
    DATE_MODIFIED_GMT,
    EXCLUDED_PRODUCT_IDS,
    FREE_SHIPPING,
    AMOUNT,
    USAGE_LIMIT_PER_USER,
    MAXIMUM_AMOUNT,
    EMAIL_RESTRICTIONS,
    DATE_EXPIRES,
    EXCLUDE_SALE_ITEMS,
    CODE,
    PRODUCT_CATEGORIES,
    DATE_CREATED,
    DESCRIPTION
FROM {{ ref('stg_coupon_montem') }}
where not _FIVETRAN_DELETED